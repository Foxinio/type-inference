
type t1 = A1 | B1

let map_pair p1 p2 =
	((fst p1) (fst p2), (snd p1) (snd p2))

let f1 a1 =
	type t2 = A2 | B2
	let f2 a2 =
		type t3 = A3 | B3
		let g3 b3 =
			match b3 with
			| A3 -> A2
			| B3 -> B2
		in (match a2 with
			| A2 -> A3
			| B2 -> B3)
	let g2 b2 =
		match b2 with
		| A2 -> A1
		| B2 -> B1
	in g2 (match a2 with
		| A1 -> A2
		| B1 -> B2)

let _ = map_pair (f1, f1) (A1, B1)
//@stderr: Levels difference.*t3
//@stderr: Fatal_error
//@code: 1
